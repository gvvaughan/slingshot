2013-12-08  Gary V. Vaughan  <gary@gnu.org>

	Release version 5
	* NEWS: Record release date.

	syntax-check: exclude gnupload from some sanity checks.
	* build-aux/sanity-cfg.mk (EXTRA_DIST): Add build-aux/sanity-cfg.mk.
	Exclude gnupload from GPL_version and two_space_separator_in_usage
	checks.

	build-aux: sync gnupload with gnulib upstream.
	* build-aux/gnupload: Update from gnulib.

	release: remove disembodied "|| exit 1" from no-submodule-changes.
	* build-aux/release.mk (no-submodule-changes): Even though the
	unchanged syntax still matches what's in upstream gnulib... I
	can't parse it, and neither can my shell.  Removing the errant
	'|| exit 1' clause fixes the error message for me (/bin/bash:
	 -c: line 1: syntax error: unexpected end of file).
	* NEWS: Update.

	maint: Update NEWS.
	* NEWS: Update.

	travis: update to luarocks-2.1.1.
	* travis.yml.in (env): Bump LUAROCKS_BASE to luarocks-2.1.1.
	* .travis.yml: Regenerate.

	maint: regenerate .travis.yml.
	* .travis.yml: Regenerate.

	travis: install luarocks to work properly with compiled rocks.
	* travis.yml.in (matrix): Add LUA_SUFFIX setting per Lua.
	(install): configure luarocks with matching version, suffix and
	include settings.

	travis: restore library links for system libyaml.
	Recent Travis CI VMs are missing libraries for libyaml in the
	standard compiler search path.  Put them back in that case.
	* travis.yml.in (install): If libyaml.so is not in /usr/lib,
	search for suitable libraries and link them into place.

2013-09-27  Gary V. Vaughan  <gary@gnu.org>

	mkrockspecs: sort generated rockspec tables asciibetically.
	* src/mkrockspecs.in (format): Collect and sort keys within
	tables before returning stringification in order.
	* NEWS: Update.

2013-09-25  Gary V. Vaughan  <gary@gnu.org>

	release: fix a typo in check-in-release-branch.
	* build-aux/release.mk (check-in-release-branch): If we need to
	create a new release branch, branch at the just tagged release,
	rather than relying on there being no release history prior to
	using this rule for the first time.

	maint: remove build-aux/git-version-gen.
	* build-aux/git-version-gen: Remove.  This script conflicts with
	the way mkrockspecs expects versions to be formatted.

	configury: support client set gitlog-to-changelog arguments.
	* build-aux/release.mk (ChangeLog): If gitlog_args macro is set,
	then pass it to gitlog-to-changelog script.

	maint: add .version to gitignore.
	* .gitignore: ignore .version.

	travis: support non-travis using projects.
	* build-aux/release.mk (_travis_yml): New macro, can be set to
	empty in local.mk to prevent travis rules being triggered.
	(release_extra_dist): Use it instead of hard-coding.

	maint: add some gnulib scripts used by GNU Zile.
	Add a few additional files to enable Zile to use slingshot instead
	of tracking a fully blown gnulib subproject for the same.
	* README-release, build-aux/git-version-gen, build-aux/gnupload,
	build-aux/update-copyright: Copied from gnulib.
	* Makefile.am (doc_DATA): New declaration to support Zile.

2013-09-16  Gary V. Vaughan  <gary@gnu.org>

	bootstrap: sync with upstream.
	* bootstrap: Pick up recent fixes from upstream.

2013-09-12  Gary V. Vaughan  <gary@gnu.org>

	announcement: show luarocks install command correctly.
	* build-aux/release.mk (announcement): Format improvements.
	* NEWS: Update.

	specl: SPECL_OPTS now works correctly.
	* GNUmakefile (SPECL_OPTS): Append the verbose option, even when
	there are additional user-defined SPECL_OPTS.
	* NEWS: Update.

2013-08-30  Gary V. Vaughan  <gary@gnu.org>

	bootstrap: sync with upstream.
	* bootstrap: Sync with upstream, to fix a bug that still clones
	gnulib into the build tree even when gnulib_tool=true is set by
	bootstrap.conf.
	* gnulib: Not used.  Remove.

	configury: bump release version to 5.
	* configure.ac (AC_INIT): Bump release version to 5.

	maint: post-release administrivia.
	* NEWS: Add header line for next release.
	* .prev-version: Record previous version.
	* ./local.mk (old_NEWS_hash): Auto-update.

	Release version 4
	* NEWS: Record release date.

	maint: patch corrupted old_NEWS_hash.
	* local.mk (old_NEWS_hash): Regenerate.

	maint: update NEWS.
	* NEWS: Update with user visible changes since the last release.

	configury: bump release version to 4.
	* configure.ac (AC_INIT): Bump release version to 4.

	configury: keep gnulib revision under version control.
	* .gitignore: Add .gitmodules.
	* gnulib: Add current master revision.

	mkrockspecs: speed up mkrockspecs when luaposix is available.
	* src/mkrockspecs.in (tree): Prefer a much faster implementation
	when luaposix is available.

	specs: speed up most slow tests by three orders of magnitude.
	* specs/mkrockspecs_spec.yaml: The gnulib tree is huge and
	deep, so using os.execute to traverse all of it with subshells
	is incredibly slow.  Only the last spec needs it, the rest are
	much improved by putting the test fils in a subdirectory and
	traversing only that.

2013-08-29  Gary V. Vaughan  <gary@gnu.org>

	bootstrap: sync with upstream.
	* bootstrap: Use the latest upstream version with better portability
	to OpenBSD, and CLI compatibility with the GNU bootstrap script.

2013-08-26  Gary V. Vaughan  <gary@gnu.org>

	mkrockspecs: don't dereference the lyaml.load return table.
	* src/mkrockspecs.in: Now that we expect the API to be consistent
	for the next release of lyaml, no need to dereference the return
	value of lyaml.load.

	mkrockspecs: lyaml 4 will be API compatible after all.
	* src/mkrockspecs.in: Remove table hacks for previously expected
	API incompatible lyaml 4.

	Merge accidentally diverged branch 'pending'

2013-07-28  Gary V. Vaughan  <gary@gnu.org>

	mkrockspecs: compatibility with lyaml > 3.
	lyaml > 3 returns all documents in a YAML stream as a table, not
	just the first document.
	* src/mkrockspecs.in: Detect lyaml 4+ by whether `require "yaml"`
	works, or else wrap the lyaml.load function return value in a
	table.
	* NEWS: Update.

2013-07-15  Gary V. Vaughan  <gary@gnu.org>

	m4: avoid installing luarocks version of current package.
	* m4/slingshot.m4 (SS_CONFIG_TRAVIS): Skip adding the previous
	release luarock version of this package to EXTRA_ROCKS.

	configury: strip trailing whitespace from generated .travis.yml.
	When a slingshot client does NOT use ldoc or luadoc, then
	GENDOC is empty, and correctly commented out in the generated
	.travis.yml, but leaves behind a trailing space after configure
	substitutions that has to be removed manually.
	* m4/slingshot.m4 (AC_CONFIG_FILES): Strip trailing whitespace.
	* .travis.yml: Regenerate.

2013-06-28  Gary V. Vaughan  <gary@gnu.org>

	release: remove git submodules before .gitmodules file.
	* build-aux/release.mk (check-in-release-branch): Don't run `git
	clean` (which removes .gitmodules) until after submodule-extract-
	spec has had a chance to remove any submodule directories from the
	relase branch.

	typo: use 'regexp' consistently in release.mk.
	* release.mk: Fix missing 'p' in regexp typo.

	sanity: don't complain about git submodule directories.
	* build-aux/sanity.mk (_sc_excl): Add gnulib and slingshot to
	exclusion list.

	release: be sure to remove submodules on the release branch.
	* build-aux/release.mk (check-in-release-branch): Add an expression
	to delete git submodules before unpacking the release tarball.

	travis: regenerate .travis.yml.
	* .travis.yml: Regenerate.

	configury: add lua header fallback when cross compiling.
	* m4/ax_lua.m4 (AX_LUA_HEADERS): Assume header version has been
	set up correctly when cross-compiling.
	From Christian Ege.

	travis: handle luadoc and ldoc specially.
	Both luadoc and ldoc behave badly with lua5.2 on Travis' Ubuntu
	Precise distros, but work properly if installed separately into
	the system luarocks tree when called from a wrapper script.
	* m4/slingshot.m4 (SS_CONFIG_TRAVIS): Generalise special Luadoc
	support ldoc too, substituting GENDOC and GENDOC_FALSE into...
	* travis.yml.in: ...here, where LUADOC support is also factored to
	work with ldoc.
	* NEWS: Update.

2013-05-25  Gary V. Vaughan  <gary@gnu.org>

	release: copy scm_rockspec to release branch.
	* Makefile.am (save_release_files): Default setting.
	* build-aux/rockspecs.mk (save_release_files): Add scm_rockspecs.

2013-05-23  Gary V. Vaughan  <gary@gnu.org>

	README: note use of slingshot_files variable.
	* README.md (Installation): Note use of slingshot_files variable.

	typo: spell 'locally' correctly in README.md.
	* README.md (Usage): Spell locally correctly.

2013-05-19  Gary V. Vaughan  <gary@gnu.org>

	bootstrap: fix location of mkrockspecs.in.
	* bootstrap.slingshot (slingshot_require_slingshot_submodule):
	mkrockspecs.in moved from build-aux to src.

	maint: post-release administrivia.
	* NEWS: Add header line for next release.
	* .prev-version: Record previous version.
	* ./local.mk (old_NEWS_hash): Auto-update.

	Release version 3
	* NEWS: Record release date.

	configury: bump release version to 3.
	* configure.ac (AC_INIT): Bump release version to 3.

	mkrockspecs: put source in src directory.
	* build-aux/mkrockspecs.in: Move from here...
	* src/mkrockspecs.in: ...to here.
	* configure.ac (AC_CONFIG_FILES): Adjust.

	bootstrap: don't overwrite user settings in bootstrap.slingshot.
	* bootstrap.slingshot (slingshot_files, slingshot_path)
	(slingshot_url): Don't blindly set to empty, in case this file
	is sourced *after* user settings.

	bootstrap: diagnose missing slingshot_files settings.
	* bootstrap.slingshot (slingshot_files): Add dummy setting with
	doc-comment.
	(slingshot_copy_files): Check slingshot_files is set.

	configury: support non-autotools LuaRocks installation.
	* build-aux/mkrockspecs.in: Add a Bourne shell preamble to make
	a PATH search for suitable Lua binary and re-execute.
	Support new --module-dir command-line option to specify a tree
	of `.lua` files for installation, in preference to a full auto-
	tools build.
	Collect and correctly quote a LuaRocks `build.modules` table in
	the generated rockspec when --module-dir is passed.
	Also, await rockspec configuration on standard input when new
	positional parameter for FILE is '-'.
	* specs/package_spec.yaml: Remove dummy spec file.
	* specs/mkrockspecs_spec.yaml: Verify behaviour of new functions
	in mkrockspecs.
	* specs/specs.mk (specl_SPECS): Adjust.
	* build-aux/mkrockspecs.mk ($(package_rockspec)): Support optional
	mkrockspecs_args for user arguments to mkrockspecs script.
	* NEWS: Update.

	README: update and expand.
	* README.md (Installation): Document the `bootstrap.slingshot`
	method, as well as "pick and choose" alternative.
	(ax_with_prog.m4, mail): Remove.  These files are no longer part
	of Slingshot.
	* AUTHORS: Update.

	configury: remove Automake foreign requirement.
	The only thing forcing us to use the hobbled "foreign" mode of
	Automake is lack of COPYING and README files.  Adding them has
	the added benefit of distributing a standard README file in
	releases, but keeping README.md in the repository, which looks
	nicer on github.
	* COPYING: New file. Catch all license for files that don't have
	their own explicit terms.
	* bootstrap.conf (slingshot_force_readme): Link to README.md.
	* configure.ac (AM_INIT_AUTOMAKE): Remove foreign.
	(AX_PROG_LUA): Quote arguments correctly.
	* .gitignore: Add COPYING and README.
	* NEWS: Update.

	configury: Makefile.am improvements.
	* Makefile.am (dist_bin_SCRIPTS, dist_lua_DATA): Declare these
	here, so that multiple fragments can each add additional files.
	(EXTRA_DIST): Don't force distribution of README.md.
	* local.mk (EXTRA_DIST): Add README.md.

2013-05-09  Gary V. Vaughan  <gary@gnu.org>

	.gitignore: ignore configure.lineno scripts.
	* .gitignore: Add '/config*.lineno'.

2013-05-06  Gary V. Vaughan  <gary@gnu.org>

	configury: propagate $(LUA_INCLUDE) to the compiler.
	* Makefile.am (AM_CPPFLAGS): Set to $(LUA_INCLUDE).

	refactor: move a single quoted backslash to play nicely with font-lock.
	* build-aux/release.mk (announcement): change from '...\' to
	'...'\\, which doesn't throw font lock out completely for the
	rest of the file!

	sanity: support local configuration.
	* bulid-aux/sanity.mk: Include build-aux/sanity.cfg if available.
	(sc_prohibit_strcmp): Don't flag `strncpy()` as an invocation.

	configury: be more sympathetic to library module packagers.
	* Makefile.am (LUA_CPATH): Set to ';' unless overriddeb by the
	environment.
	(EXTRA_LTLIBRARIES, lib_LTLIBRARIES): New declarations.

	mkrockspecs: allow .git suffix in YAML spec.source.url.
	* build-aux/mkrockspecs.in: Strip any trailing .git suffix
	from spec.source.url to get the basename for generating git
	and release rockspecs.

	release: distribute bootstrap.slingshot.
	* build-aux/release.mk (release_extra_dist): Add bootstrap.slingshot.

	travis: make the local lua5.1 hacked luadoc executable!
	* travis.yml.in (global.LUADOC): New environment variable.
	(install): Use it to create and chmod a lua5.1 hacked wrapper.
	* .travis.yml: Regenerate.

	travis: skip normal install of luadoc after special install.
	* m4/slingshot.m4: Don't install luadoc twice... the one with
	the selected Lua interpreter always fails with Lua 5.2!

	travis: regenerate .travis.yml.
	* .travis.yml: Regenerate.

	travis: make sure luarocks paths are set before installing EXTRA_ROCKS.
	* travis.yml.in (script): Move @EXTRA_ROCKS@ after path setting.
	* m4/slingshot.m4 (SS_CONFIG_TRAVIS): Remove SPECL_FALSE.
	* travis.yml.in (script): Likewise.

	travis: consolidate special treatment for luadoc and specl.
	* m4/slingshot.m4 (SS_CONFIG_TRAVIS): Set up substitutions keyed
	on whether 'luadoc' or 'specl' appear in the argument list.
	* configure.ac (SS_CONFIG_TRAVIS): Add specl.
	* travis.yml.in: Set up a subsitution to comment or uncomment the
	appropriate special handling of luadoc and specl.
	* .travis.yml: Regenerate.

	travis: shell picks up locally installed luarocks/bin scripts.
	* travis.yml.in (script): Prepend luarocks bin directory to PATH.

	travis: detect duplicate EXTRA_ROCKS correctly.
	* m4/slingshot.m4 (SS_CONFIG_TRAVIS): Don't forget the '*'s!

	bootstrap: don't git submodule update everytime bootsttrap executes.
	* bootstrap.slingshot (slingshot_require_slingshot_submodule):
	Move the `git submodule` calls inside the if branch that makes a
	fresh submodule checkout.

	configury: support multiple EXTRA_ROCKS correctly.
	* m4/slingshot.m4 (SS_TRAVIS_YML): New autoconf macro.
	* configure.ac, travis.yml.in: Adjust.
	* .travis.yml: Regenerate.

	configury: use Automake-time includes, not Make time.
	* Makefile.am: Using '-include' delays reading of included files
	until Make time, which means they are not expanded by Automake.
	Don't do that!

	bootstrap: use the read-only for slingshot subproject clone.
	* bootstrap.slingshot (slingshot_require_slingshot_dotgitmodules):
	Aside from requiring authentication, and SSH fingerprint
	confirmation, the SSH slingshot git url hangs Travis.  Using the
	public read-only URL fixes it.

	bootstrap: add a bootstrap.conf fragment for slingshot superprojects.
	* bootstrap.slingshot: New file. Source this from bootstrap.conf to
	integrate slingshot.

	travis: make additional bootstrap rocks configurable.
	* configure.ac (EXTRA_ROCKS): Set to lyaml, which is always
	needed to run slingshot mkrockspecs.
	* travis.yaml.in: Use @EXTRA_ROCKS@ instead of hard-coding.

	configury: support minimum specl version assertion.
	* configure.ac (SPECL_MIN): Set and substitute a sensible minimum.
	* build-aux/specl.mk (specl-check-local): Bail out if specl is too
	old.

	configury: don't fail on missing make fragments.
	* Makefile.am: Use `-include` so that this file is useful in a
	parent project that doesn't have all the listed fragments.
	* local.mk: Put project specific fragment includes here.

2013-05-05  Gary V. Vaughan  <gary@gnu.org>

	travis: regenerate .travis.yml.
	* .travis.yml: Regenerate.

	travis: fix a typo.
	* travis.yml.in (script): Spell SPECL correctly.

	configury: fix a typo.
	* configure.ac (AC_PATH_PROG): Spell false correctly.

2013-05-02  Gary V. Vaughan  <gary@gnu.org>

	release: redo announcements without mutt mail wrapper.
	* build-aux/mail: Remove.
	* build-aux/relase.mk (announcement): Reword.
	(announce_emails, rockspec_emails): Overridable announcement
	destination addresses.
	(mail): Use system `mail` by sending rockspec url rather than
	an attachment.
	NEWS: Update.

	maint: move old_NEWS_hash into local.mk.
	* Makefile.am (old_NEWS_hash): Move from here...
	* local.mk: New file. ...to here.
	* build-aux/release.mk (old_NEWS_hash-file): Adjust.
	(release_extra_dist): Add local.mk.

	travis: set SPECL_FALSE for .travis.yml generation.
	* configure.ac: set SPECL_FALSE for .travis.yml generation.

	configury: remove ax_with_prog.m4.
	* m4/ax_with_prog.m4: Remove.
	* configure.ac: Use AC_PATH_PROG instead of AX_WITH_PROG.

	specl: automate specl support.
	* configure.ac: Add SPECL path search and substition.
	* build-aux/specl.mk: Rules to run specl tests.
	* specs/specs.mk: Remove everything but the specs list.
	* travis.yml: On Travis, SPECL is either the one we build into
	bin/ otherwise we install the specl rock to luarocks/bin.
	* .travis.yml: Regenerate.

	travis: pass the SPECL location to make check.
	* travis.yml.in (script): pass the SPECL location to make check.

	travis: install specl before running self-tests.
	* travis.yml.in: install specl before running self-tests.
	* .travis.yml: Regenerate.

	travis: let LuaRocks install dependencies and catch any missed.
	* travis.yml.in (script): Remove inessential rock preinstallations.
	Don't forget to run self-tests.
	* .travis.yml: Regenerate.

	configury: remove unused auxdir macro.
	* Makefile.am (auxdir): Remove.

	maint: distribute README.md.
	* Makefile.am (EXTRA_DIST): Add README.md.

2013-04-29  Gary V. Vaughan  <gary@gnu.org>

	maint: update NEWS.
	* NEWS: Update.

	sanity: Lua `error` does not require translatable strings.
	* build-aux/sanity.mk (_gl_translatable_diag_func_re): Use
	`error_` instead of `error` to avoid false matches against the
	Lua `error` keyword.

	configury: distribute README.md too.
	* Makefile.am (EXTRA_DIST): Add README.md.

	maint: remove reference to removed woger release dependency.
	* README.md: Don't mention woger -- we don't use it any more!

	maint: definition list reformatting.
	* README.md: Add some blank lines around list items to get a
	definition-list-like display.

	release: distribute .autom4te.cfg.
	* build-aux/release.mk (release_extra_dist): Add .autom4te.cfg.

	maint: post-release administrivia.
	* NEWS: Add header line for next release.
	* .prev-version: Record previous version.
	* ./Makefile.am (old_NEWS_hash): Auto-update.

	Release version 2
	* NEWS: Record release date.

	maint: News updated.
	* NEWS: updated.

	release: add submodule checks to release rules.
	* build-aux/release.mk (no-submodule-changes): Make sure we can't
	accidentally release with unchecked-in submodule changes.
	(public-submodule-commit): Make sure we can't accidentally release
	with unpushed local submodule changes.
	(submodule-checks): List them.
	(release): Run the checks.

	sanity: port over gnulib sanity checking rules.
	* build-aux/sanity.mk: Sanity checks from gnulib maint.mk.
	* README.md: Document it.
	* GNUmakefile: Include it.
	(distcheck): Run sanity checks too.
	(ME): Fix typo found by sanity checks.
	* build-aux/release.mk: Fix whitespace errors found by sanity
	checks.
	* build-aux/rockspecs.mk: Fix typo found by sanity checks.

	release: add maintainer support scripts to distribution by default.
	* build-aux/release.mk (release_extra_dist): List all the support
	scripts used by release.mk.
	(EXTRA_DIST): Append them.

	release: add .PHONY tag to push and mail targets.
	* build-aux/release.mk (push, mail): Move to end of file. Add
	.PHONY tag.

	release: ensure git rockspec is available for announcement.
	* build-aux/release.mk (announcement): Add depedency on scm_rockspec.

2013-04-28  Gary V. Vaughan  <gary@gnu.org>

	release: create new release branch at v1 tag.
	* build-aux/release.mk (check-in-release-branch): If there is no
	release branch yet, create the new at the v1 tag rather than the
	current HEAD of master (which is probably a post-release admin-
	istrivia commit).

	maint: post-release administrivia.
	* configure.ac (AC_INIT): Bump version to 2 for next release.
	* NEWS: Add header line for next release.
	* .prev-version: Record previous version.
	* ./Makefile.am (old_NEWS_hash): Auto-update.

	Release version 1
	* NEWS: Record release date.

	configury: add autom4te.cache disabling configuration file.
	* .autom4te.cfg: New file. Disable the cache.
	* README.md: Document it.

	bootstrap: use the correct bootstrap script.
	* bootstrap: The full version!
	* bootstrap.conf: Ensure ChangeLog for Automake.

	release: import mutt mail wrapper.
	* build-aux/mail: Import mutt mail wrapper.
	* README.md: Note the addition of mail script.

	release: remove woger dependency.
	* build-aux/release.mk (WOGER, WOGER_ENV, WOGER_OUT): Remove.
	(release): Split into...
	(push): ...this one to push git changes back to origin...
	(mail): ...and this one to make mailing list announcements.
	(announcement): Produce a full release announcement message body.

	release: elide 'remote end hung up' error on first release.
	* build-aux/release.mk (check-in-release-branch): Elide the
	misleading 'remote end hung up' error when failing to pull the
	not-yet-created release branch updates into the local tree.

	specs: rudimentary specl demo.
	* specs/specs.mk (SPECL): Use installed specl binary.
	(specl-check-local): Remove SPECL dependency, and call directly.
	* specs/package_spec.yaml: A minimal spce file.
	* src/src.mk (EXTRA_DIST): Fix a typo.
	* build-aux/release.mk (EXTRA_DIST): Distribute travis.yml.in.
	(all-am): Keep .travis.yml up to date by default.

	travis: ensure availability of help2man.
	* src/src.mk (docs/mkrockspecs.1): No need to call `missing` when
	configure already sets HELP2MAN appropriately.
	* travis.yml.in (install): Install help2man.
	* .travis.yml: Regenerate.

	maint: fix a typo in rockspec.conf
	* rockspec.conf (homepage): Use the correct project url!

	travis: make sure lyaml is installed.
	* travis.yml.in: install lyaml to the local rocks tree.
	* .travis.yml: Regenerate.

	maint: add travis support.
	* .travis.yml: New file. Generated from travis.yml.in.
	* .gitignore: Remove .travis.yml.
	* src/src.mk: Fix typos.
	* README.md: Add slingshot URL.

	Initial import.
